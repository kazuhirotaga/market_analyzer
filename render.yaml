services:
  # ----------------------------------------------------------------------------
  # Cron Job: 毎日決まった時間にスクリプトを実行
  # メモリ: Starterプラン以上推奨 (MLモデル読み込みのため)
  # ----------------------------------------------------------------------------
  - type: cron
    name: market-analyzer-daily
    env: python
    plan: starter
    region: singapore # 日本に近いリージョン
    schedule: "0 9 * * *" # UTC 9:00 = JST 18:00
    buildCommand: "pip install -r requirements.txt"
    startCommand: "python scripts/run_daily.py"
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: GEMINI_API_KEY
        sync: false
      - key: NEWSAPI_KEY
        sync: false
      - key: NEWSDATA_KEY
        sync: false
      - key: MARKETAUX_KEY
        sync: false
      - key: SMTP_HOST
        sync: false
      - key: SMTP_PORT
        sync: false
      - key: SMTP_USER
        sync: false
      - key: SMTP_PASSWORD
        sync: false
      - key: SMTP_RECIPIENT
        sync: false
      - key: DATABASE_URL
        sync: false

# データベース (オプション: 永続化が必要な場合)
# PostgreSQLを使用する場合、以下のコメントを外してください
# databases:
#   - name: market-analyzer-db
#     databaseName: market_analyzer
#     user: market_user
#     plan: starter
